name: LLM Security Scan

on:
  push:
    tags:
      # Run on tags matching semantic versioning pattern (v1.0.0, v2.1.3, etc.)
      - 'llmscan*.*.*'
      # Alternative patterns you can use:
      # - 'v[0-9]+.[0-9]+.[0-9]+'           # Strict semantic versioning
      # - 'v[0-9]+.[0-9]+.[0-9]+(-.*)?'     # With optional pre-release suffix
      # - 'release-*'                       # Any tag starting with 'release-'
  workflow_dispatch:
    inputs:
      tag_name:
        description: 'Tag name to scan (e.g., v1.0.0)'
        required: false
        type: string

jobs:
  scan:
    uses: ./.github/workflows/llm-scan-reusable.yml
    with:
      # scanner_repo not needed when calling from same repo
      paths: '.'
      exclude_patterns: 'tests/**,.github/**,**/__pycache__/**'
    secrets:
      GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
